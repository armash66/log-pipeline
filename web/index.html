<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Log Pipeline Console</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="bg">
      <div class="orb orb-a"></div>
      <div class="orb orb-b"></div>
      <div class="grid"></div>
    </div>

    <aside class="sidebar" id="sidebar">
      <div class="sidebar-head">
        <span class="brand">Log Pipeline</span>
        <button id="sidebar-close" class="icon-btn" aria-label="Close menu">✕</button>
      </div>
      <nav class="sidebar-nav">
        <button class="nav-link active" data-page="home">Home</button>
        <button class="nav-link" data-page="help">Help</button>
      </nav>
      <div class="sidebar-foot">
        <a class="sidebar-link" href="https://github.com/armash66" target="_blank" rel="noreferrer">github.com/armash66</a>
      </div>
    </aside>
    <div class="sidebar-backdrop" id="sidebar-backdrop"></div>

    <main class="app">
      <header class="hero">
        <button id="sidebar-open" class="icon-btn" aria-label="Open menu">☰</button>
        <div>
          <p class="eyebrow">Log Pipeline</p>
          <h1>Query Console</h1>
          <p class="sub">
            Fast filters, live polling, and a clean view of your logs.
          </p>
        </div>
        <div class="status">
          <div class="status-card">
            <span class="label">API</span>
            <span id="health" class="value">unknown</span>
          </div>
          <div class="status-card">
            <span class="label">Last Query</span>
            <span id="last-query" class="value">never</span>
          </div>
        </div>
      </header>

      <section class="page" id="page-home">
      <section class="controls">
        <div class="control">
          <label for="level">Level</label>
          <select id="level">
            <option value="">Any</option>
            <option value="ERROR">ERROR</option>
            <option value="WARN">WARN</option>
            <option value="INFO">INFO</option>
            <option value="DEBUG">DEBUG</option>
          </select>
        </div>
        <div class="control">
          <label for="search">Search</label>
          <input id="search" type="text" placeholder="message contains..." />
        </div>
        <div class="control">
          <label for="since">Since</label>
          <input id="since" type="text" placeholder="10m, 2h30m, 1d, 1w2d" />
        </div>
        <div class="control">
          <label for="after">After (UTC)</label>
          <input id="after" type="text" placeholder="2026-02-08T16:00:00Z" />
        </div>
        <div class="control">
          <label for="before">Before (UTC)</label>
          <input id="before" type="text" placeholder="2026-02-08T17:00:00Z" />
        </div>
        <div class="control">
          <label for="limit">Limit</label>
          <input id="limit" type="number" min="0" value="50" />
        </div>
        <div class="control wide">
          <label for="q">DSL Query</label>
          <input id="q" type="text" placeholder='level=ERROR OR level=WARN message~"auth"' />
        </div>
        <div class="control buttons">
          <button id="run">Run Query</button>
          <button id="clear" class="ghost">Clear</button>
        </div>
      </section>

      <section class="controls upload">
        <div class="control">
          <label for="upload">Upload Log File</label>
          <input id="upload" type="file" />
          <p class="helper">Upload a log file in plain, JSON, or logfmt format.</p>
        </div>
        <div class="control">
          <label for="upload-format">Upload Format</label>
          <select id="upload-format">
            <option value="auto">auto</option>
            <option value="plain">plain</option>
            <option value="json">json</option>
            <option value="logfmt">logfmt</option>
          </select>
          <p class="helper">Use auto unless you know the format.</p>
        </div>
        <div class="control">
          <label for="upload-replace">Ingest Mode</label>
          <select id="upload-replace">
            <option value="replace">Replace current data</option>
            <option value="append">Append to current data</option>
          </select>
          <p class="helper">Replace shows only the uploaded file in results.</p>
        </div>
        <div class="control">
          <label for="upload-btn">Upload Action</label>
          <div class="upload-action">
            <button id="upload-btn">Upload & Ingest</button>
            <span id="upload-status" class="helper"></span>
          </div>
        </div>
      </section>

      <section class="panels">
        <div class="panel">
          <div class="panel-head">
            <h2>Results</h2>
            <span id="count" class="pill">0 logs</span>
          </div>
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>Timestamp</th>
                  <th>Level</th>
                  <th>Message</th>
                </tr>
              </thead>
              <tbody id="rows"></tbody>
            </table>
          </div>
        </div>
        <div class="panel">
          <div class="panel-head">
            <h2>Metrics</h2>
            <span id="rate" class="pill">rate: NA</span>
          </div>
          <div class="metrics" id="metrics"></div>
        </div>
      </section>
      </section>

      <section class="page hidden" id="page-help">
        <div class="panel">
          <div class="panel-head">
            <h2>Website Help</h2>
          </div>
          <div class="help">
            <p><strong>Start:</strong> Run the server and open <code>http://localhost:8080/ui/</code>.</p>
            <p><strong>Run Query:</strong> Pick filters or use the DSL box, then click <em>Run Query</em>.</p>
            <p><strong>Upload:</strong> Choose a log file, select format (auto/plain/json/logfmt), pick ingest mode, then click <em>Upload &amp; Ingest</em>.</p>
            <p><strong>Replace vs Append:</strong> Replace shows only the uploaded file. Append adds to existing logs.</p>
            <p><strong>Since examples:</strong> <code>10m</code>, <code>2h30m</code>, <code>1d</code>, <code>1w2d</code>.</p>
            <p><strong>DSL examples:</strong> <code>level=ERROR OR level=WARN</code>, <code>level in (ERROR,WARN) message~"auth"</code>.</p>
          </div>
        </div>
      </section>

      <footer class="footer">
        <span>Built by Armash</span>
        <a href="https://github.com/armash66" target="_blank" rel="noreferrer">github.com/armash66</a>
      </footer>
    </main>

    <script src="app.js"></script>
  </body>
</html>
